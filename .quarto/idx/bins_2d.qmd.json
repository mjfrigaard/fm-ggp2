{"title":"2D histograms","markdown":{"headingText":"2D histograms","headingAttr":{"id":"","classes":["unnumbered"],"keyvalue":[]},"containsRefs":false,"markdown":"\n```{r}\n#| label: setup\n#| message: false\n#| warning: false\n#| include: false\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(scales)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(colorblindr)\nlibrary(downlit)\n# fonts ----\nlibrary(extrafont)\nlibrary(sysfonts)\nsource(\"_common.R\")\n# use font\nshowtext::showtext_auto()\n# set theme\nggplot2::theme_set(theme_ggp2g(\n    base_size = 15))\n```\n\n```{r}\n#| label: status\n#| results: \"asis\"\n#| echo: false\n# status ----\n# polish, dev, draft, complete\nstatus(\"complete\")\n```\n\n\n:::: {.callout-note collapse=\"false\" icon=false}\n\n::: {style=\"font-size: 1.25em; color: #02577A;\"}\nGraph info\n:::\n\n<br>\n\n```{r}\n#| label: full_code_display\n#| eval: true\n#| echo: false\n#| warning: false\n#| message: false\n#| out-height: '60%'\n#| out-width: '60%'\n#| fig-align: right\nlibrary(palmerpenguins) \nlibrary(ggplot2)\npenguins_2dhist <- palmerpenguins::penguins |> \n    dplyr::select(flipper_length_mm, bill_length_mm, year) |> \n    tidyr::drop_na()\n\nlabs_2dhist <- labs(\n    title = \"Adult Foraging Penguins\", \n    subtitle = \"Near Palmer Station, Antarctica\", \n    x = \"Bill length (mm)\", \n    y = \"Flipper length (mm)\")\n\nggp2_base <- ggplot(data = penguins_2dhist, \n    mapping = aes(x = bill_length_mm, \n                  y = flipper_length_mm)) \n\nggp2_base + \n     geom_bin2d(bins = 15) + \n     labs_2dhist \n```\n\n::: {style=\"font-size: 1.10em; color: #02577A;\"}\n**This graph requires:**\n:::\n\n::: {style=\"font-size: 1.05em; color: #282b2d;\"}\n**`r emo::ji(\"check\")` two numeric (continuous) variables**\n:::\n\n::::\n\n## Description \n\nStandard histograms separate a variable's values into discrete groups, or 'bins,' which are arranged in increasing order across the `x` axis. The `y` axis displays the frequency (or count) of values within each bin. \n\nVertical bars capture the variable's distribution using the height of the bar to represent the number of values per 'bin', and the number of bars corresponds with the bin value (or 'bin-width'). \n\nWhen we extend this display to two numerical/quantitative variables, the bins are used to divide the total graph area into a grid, and color is used to display the variation in frequency (or count) of both variable values that fall within each intersecting square.\n\n\n## Getting set up\n\n:::: {.panel-tabset}\n\n### Packages\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**PACKAGES:**\n:::\n\n::: {style=\"font-size: 0.85em;\"}\nInstall packages.\n:::\n\n\n::: {style=\"font-size: 0.75em;\"}\n```{r}\n#| label: pkg_code_2d_hist\n#| code-fold: show\n#| eval: false\n#| echo: true\n#| warning: false\n#| message: false\n#| results: hide\ninstall.packages(\"palmerpenguins\")\nlibrary(palmerpenguins)\nlibrary(ggplot2)\n```\n:::\n\n### Data\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**DATA:**\n:::\n\n::: {.column-margin}\n![Artwork by allison horst](www/lter_penguins.png){fig-align=\"right\" width=\"100%\" height=\"100%\"}\n:::\n\n::: {style=\"font-size: 0.85em;\"}\nWe'll take the `flipper_length_mm`, `bill_length_mm`, and `species` variables from `palmerpenguins::penguins` and drop the missing values. \n:::\n\n::: {style=\"font-size: 0.75em;\"}\n```{r}\n#| label: data_code_2d_hist\n#| code-fold: show\n#| eval: true\n#| echo: true\npenguins_2dhist <- palmerpenguins::penguins |> \n    dplyr::select(flipper_length_mm, bill_length_mm, \n                  sex, species, body_mass_g) |> \n    tidyr::drop_na()\nglimpse(penguins_2dhist)\n```\n:::\n::::\n\n## The grammar\n\n:::: {.panel-tabset}\n\n### Code\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**CODE:**\n:::\n\n::: {style=\"font-size: 0.85em;\"}\n\nCreate labels with `labs()`\n\nInitialize the graph with `ggplot()` and provide `data`\n\nMap `bill_length_mm` to the `x` and `flipper_length_mm` to the `y`\n\nAdd the `geom_bin2d()` layer\n\n:::\n\n::: {style=\"font-size: 0.75em;\"}\n```{r}\n#| label: code_graph_2d_hist\n#| code-fold: show\n#| eval: false\n#| echo: true \n#| warning: false\n#| message: false\n#| out-height: '100%'\n#| out-width: '100%'\nlabs_2dhist <- labs(\n    title = \"Adult Foraging Penguins\", \n    subtitle = \"Near Palmer Station, Antarctica\", \n    x = \"Bill length (mm)\", \n    y = \"Flipper length (mm)\")\n\nggp2_2dhist <- ggplot(data = penguins_2dhist, \n    mapping = aes(x = bill_length_mm, \n                  y = flipper_length_mm)) + \n    geom_bin2d(bins = 15)\n            \nggp2_2dhist + \n    labs_2dhist\n```\n:::\n\n### Graph\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**GRAPH:**\n:::\n\n```{r}\n#| label: create_graph_2d_hist\n#| eval: true\n#| echo: false\n#| warning: false\n#| message: false\n#| out-height: '100%'\n#| out-width: '100%'\n#| layout-ncol: 1\n#| column: page-inset-right\nlabs_2dhist <- labs(\n    title = \"Adult Foraging Penguins\", \n    subtitle = \"Near Palmer Station, Antarctica\", \n    x = \"Bill length (mm)\", \n    y = \"Flipper length (mm)\")\n\nggp2_2dhist <- ggplot(data = penguins_2dhist, \n    mapping = aes(x = bill_length_mm, \n                  y = flipper_length_mm)) + \n    geom_bin2d(bins = 15)\n            \nggp2_2dhist + \n    labs_2dhist\n```\n\n::::\n\n## More info\n\n:::: {.panel-tabset}\n\n### Bins\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**BINS:**\n:::\n\n\n::: {style=\"font-size: 0.85em;\"}\nThe value for `bins` will be vary depending on the variable values--there is no correct number. If the number of `bins` is too low, the density may hide important nuances between the variables. If the number of `bins` is too high, the noise might drown out the signal.\n\nBelow we change the `bins` to `9`, `12` and `18` to compare the display:\n:::\n\n::: {style=\"font-size: 0.75em;\"}\n```{r}\n#| label: bins_2d_hist\n#| eval: true\n#| echo: true\n#| warning: false\n#| message: false\n#| out-height: '100%'\n#| out-width: '100%'\n#| layout-nrow: 2\n#| column: page-inset-right\nggp2_base <- ggplot(data = penguins_2dhist, \n    mapping = aes(x = bill_length_mm, \n                  y = flipper_length_mm))\n\nggp2_2dhist_bins18 <- ggp2_base + \n                    geom_bin2d(bins = 18)\n\nggp2_2dhist_bins12 <- ggp2_base + \n                    geom_bin2d(bins = 12) \n\nggp2_2dhist_bins9 <- ggp2_base + \n                    geom_bin2d(bins = 9)\n\nggp2_2dhist_bins18 + \n     labs_2dhist \n\nggp2_2dhist + \n    labs_2dhist\n\nggp2_2dhist_bins12 + \n     labs_2dhist \n\nggp2_2dhist_bins9 + \n  labs_2dhist\n```\n\n:::\n\n### Scale\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**SCALES:**\n:::\n\n::: {style=\"font-size: 0.85em;\"}\n`scale_fill_continuous_sequential()` comes with a variety of palettes to choose from (run `hcl_palettes(type = \"sequential\")` to view the full list).\n\nWe can also reverse the order of the fill color scale with `rev` (`TRUE` or `FALSE`).\n:::\n\n::: {style=\"font-size: 0.75em;\"}\n```{r}\n#| label: scales_2d_hist\n#| eval: true\n#| echo: true\n#| warning: false\n#| message: false\n#| out-height: '100%'\n#| out-width: '100%'\n#| layout-ncol: 1\n#| column: page-inset-right\nggp2_2dhist_bins12 + \n    scale_fill_continuous_sequential(\n        palette = \"Mako\", \n        rev = TRUE) +\n    labs_2dhist \n\nggp2_2dhist_bins12 + \n    scale_fill_continuous_sequential(\n        palette = \"Mako\", \n        rev = FALSE) +\n    labs_2dhist \n```\n\n:::\n\n### Options\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**OPTIONS:**\n:::\n\n::: {.column-margin}\nIf you set the point `shape` to `21`, you have control over *both* `color` and `fill`. \n:::\n\n::: {style=\"font-size: 0.85em;\"}\n\nIn the previous example we showed how to `rev`erse the color scale for the `palette` in `scale_fill_continuous_sequential()`. Below we reverse the color scale, but also manually set which colors on the scale we want to `begin` with (i.e., smallest data value) and which color we want to `end` with (i.e., the largest data value). Possible values range from `0` - `1`.\n\nWe also add a `geom_point()` layer. \n:::\n\n::: {style=\"font-size: 0.75em;\"}\n```{r}\n#| label: pals_2d_hist\n#| eval: true\n#| echo: true\n#| warning: false\n#| message: false\n#| out-height: '100%'\n#| out-width: '100%'\n#| layout-nrow: 1\n#| column: page-inset-right\nggp2_2dhist_bins12 +\n  scale_fill_continuous_sequential(\n    palette = \"SunsetDark\",\n    rev = TRUE,\n    begin = 1.0,\n    end = 0.3) +\n  geom_point(\n    fill = \"#D4F0FC\",\n    color = \"#02577A\",\n    shape = 21,\n    size = 1.8,\n    alpha = 0.60) +\n  labs_2dhist \n```\n:::\n\n::::\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"arrow","toc":true,"toc-depth":5,"number-sections":true,"dpi":320,"output-file":"bins_2d.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","bibliography":["references.bib"],"theme":["cosmo","custom.scss"],"toc-location":"right","toc-title":"Contents","code-block-bg":"#f8f8f8","code-block-border-left":"#99bbc9","code-annotations":"hover","callout-appearance":"simple","code-summary":"show/hide","fig-asp":0.618,"fontsize":"1.085em","linestretch":1.25},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}