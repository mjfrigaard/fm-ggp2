{
  "hash": "cbfaa5018cd666f089f49ce88d0f7c54",
  "result": {
    "markdown": "# Overlapping bar graphs {.unnumbered}\n\n\n\n\n\n\n\n:::: {.callout-note collapse=\"false\" icon=false}\n## Graph info\n::: {style=\"font-size: 1.25em; color: #007bff;\"}\n**Should I use this graph?**\n:::\n\n<br>\n\n\n::: {.cell layout-align=\"right\"}\n::: {.cell-output-display}\n![](overlapping_bar_graphs_files/figure-html/full_code_display-1.png){fig-align='right' width=60% height=60%}\n:::\n:::\n\n\n::: {style=\"font-size: 1.10em; color: #007bff;\"}\n**This graph requires:**\n:::\n\n::: {style=\"font-size: 1.05em; color: #fa7b3c;\"}\n**✅ a numeric (continuous) variable**\n\n**✅ a categorical variable** \n:::\n\n::::\n\n## Desription \n\nOverlapping bar graphs display counts for categorical levels, resulting in bars differentiated by color and ‘stacked’ on top of each other.\n\nIn `ggplot2`, we can build overlapping bar graphs using the `fill` argument in `geom_bar()` or `geom_col()`\n\n## Getting set up\n\n:::: {.panel-tabset}\n\n### Packages\n\n::: {style=\"font-size: 1.10em; color: #1e83c8;\"}\n**PACKAGES:**\n:::\n\n::: {style=\"font-size: 0.85em;\"}\nInstall packages.\n:::\n\n\n::: {style=\"font-size: 0.75em;\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\ninstall.packages(\"palmerpenguins\")\nlibrary(palmerpenguins)\nlibrary(ggplot2)\n```\n:::\n\n:::\n\n### Data\n\n::: {style=\"font-size: 1.10em; color: #1e83c8;\"}\n**DATA:**\n:::\n\n::: {.column-margin}\n![Artwork by Allison Horst](www/lter_penguins.png){fig-align=\"right\" width=\"100%\" height=\"100%\"}\n:::\n\n::: {style=\"font-size: 0.85em;\"}\nRemove missing `species` from `penguins` and filter the data to only penguins on `\"Dream\"` island.\n:::\n\n::: {style=\"font-size: 0.75em;\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\npenguins_ovrlp <- filter(penguins,\n                      !is.na(species) & \n                            island == \"Dream\")\nglimpse(penguins_ovrlp)\n#> Rows: 124\n#> Columns: 8\n#> $ species           <fct> Adelie, Adelie, Adelie, Adelie, …\n#> $ island            <fct> Dream, Dream, Dream, Dream, Drea…\n#> $ bill_length_mm    <dbl> 39.5, 37.2, 39.5, 40.9, 36.4, 39…\n#> $ bill_depth_mm     <dbl> 16.7, 18.1, 17.8, 18.9, 17.0, 21…\n#> $ flipper_length_mm <int> 178, 178, 188, 184, 195, 196, 19…\n#> $ body_mass_g       <int> 3250, 3900, 3300, 3900, 3325, 41…\n#> $ sex               <fct> female, male, female, male, fema…\n#> $ year              <int> 2007, 2007, 2007, 2007, 2007, 20…\n```\n:::\n\n:::\n::::\n\n## The grammar\n\n:::: {.panel-tabset}\n\n### Code\n\n::: {style=\"font-size: 1.10em; color: #1e83c8;\"}\n**CODE:**\n:::\n\n::: {style=\"font-size: 0.85em;\"}\n\nCreate labels with `labs()`\n\nInitialize the graph with `ggplot()` and provide `data`\n\nMap `flipper_length_mm` to the `x` and `species` to `fill`\n\nAdd the `geom_bar()` layer\n\n:::\n\n::: {style=\"font-size: 0.75em;\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nlabs_bar_ovrlp <- labs(\n  title = \"Adult foraging penguins on Dream island\",\n  x = \"Flipper length (mm)\",\n  y = \"Count\",\n  fill = \"Species\")\nggp2_bar_ovrlp <- ggplot(data = penguins_ovrlp,\n          aes(x = flipper_length_mm, fill = species)) +\n                geom_bar() \nggp2_bar_ovrlp + \n  labs_bar_ovrlp\n```\n:::\n\n:::\n\n### Graph\n\n::: {style=\"font-size: 1.10em; color: #1e83c8;\"}\n**GRAPH:**\n:::\n\n\n::: {.cell .column-page-inset-right layout-nrow=\"1\"}\n::: {.cell-output-display}\n![](overlapping_bar_graphs_files/figure-html/create_graph_bar_ovrlp-1.png){width=100% height=100%}\n:::\n:::\n\n\n::::\n\n## More info\n\nOverlapping bar graphs can also be built with `geom_col()`.\n\n`geom_bar()` has additional options for arranging overlapping bars. We can set the `position` argument to `\"dodge\"` or `\"dodge2`, depending on how we'd like the data displayed. \n\n\n:::: {.panel-tabset}\n\n### `geom_col()`\n\n::: {style=\"font-size: 1.10em; color: #1e83c8;\"}\n**`geom_col()`:**\n:::\n\n::: {style=\"font-size: 0.85em;\"}\nTo build an overlapping bar graph with `geom_col()`, we need to create a column with the counts for `flipper_length_mm` and `species` in the dataset. \n\nCreate the `penguins_col` data:\n:::\n\n::: {style=\"font-size: 0.75em;\"}\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_col <- penguins_ovrlp |>\n    count(species, flipper_length_mm, name = \"Count\")\n```\n:::\n\n:::\n\n\n::: {style=\"font-size: 0.85em;\"}\nMap the counts to the `y` axis, `flipper_length_mm` to the `x` axis, and `species` to `fill`.\n:::\n\n::: {style=\"font-size: 0.75em;\"}\n\n::: {.cell .column-page-inset-right layout-nrow=\"1\"}\n\n```{.r .cell-code}\nlabs_col_ovrlp <- labs(\n  title = \"Adult foraging penguins on Dream island\",\n  subtitle = \"built with 'geom_col()'\",\n  x = \"Flipper length (mm)\",\n  y = \"Count\",\n  fill = \"Species\")\nggp2_col_ovrlp <- ggplot(data = penguins_col, \n    mapping = aes(y = Count, \n        x = flipper_length_mm, \n        fill = species)) + \n    geom_col()\nggp2_col_ovrlp + \n    labs_col_ovrlp\n```\n\n::: {.cell-output-display}\n![](overlapping_bar_graphs_files/figure-html/data_code_bar_penguins_dodge-1.png){width=576}\n:::\n:::\n\n:::\n\n::: {style=\"font-size: 0.85em;\"}\nCompare the two graphs below:\n:::\n\n\n::: {.cell .column-page-inset-right layout-nrow=\"1\"}\n::: {.cell-output-display}\n![](overlapping_bar_graphs_files/figure-html/compare_bar_col-1.png){width=576}\n:::\n\n::: {.cell-output-display}\n![](overlapping_bar_graphs_files/figure-html/compare_bar_col-2.png){width=576}\n:::\n:::\n\n\n\n### `dodge`\n\n::: {.column-margin}\n\n- *`position = \"dodge\"` preserves the vertical position of a geom while adjusting the horizontal position*\n\n- *requires the grouping variable to be be specified in the global or `⁠geom_`⁠ layer*\n\n:::\n\n::: {style=\"font-size: 1.10em; color: #1e83c8;\"}\n**`dodge`:**\n:::\n\n::: {style=\"font-size: 0.85em;\"}\nCreate the `penguins_dodge` data.\n:::\n\n::: {style=\"font-size: 0.75em;\"}\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins_dodge <- filter(penguins,\n                      !is.na(species) & \n                        !is.na(sex) &\n                            island == \"Dream\")\nglimpse(penguins_dodge)\n#> Rows: 123\n#> Columns: 8\n#> $ species           <fct> Adelie, Adelie, Adelie, Adelie, …\n#> $ island            <fct> Dream, Dream, Dream, Dream, Drea…\n#> $ bill_length_mm    <dbl> 39.5, 37.2, 39.5, 40.9, 36.4, 39…\n#> $ bill_depth_mm     <dbl> 16.7, 18.1, 17.8, 18.9, 17.0, 21…\n#> $ flipper_length_mm <int> 178, 178, 188, 184, 195, 196, 19…\n#> $ body_mass_g       <int> 3250, 3900, 3300, 3900, 3325, 41…\n#> $ sex               <fct> female, male, female, male, fema…\n#> $ year              <int> 2007, 2007, 2007, 2007, 2007, 20…\n```\n:::\n\n:::\n\n::: {style=\"font-size: 0.85em;\"}\n\nCreate labels with `labs()`\n\nInitialize the graph with `ggplot()` and provide `data`\n\nMap `species` to the `x` and `island` to `group` and `fill` \n\nInside the `geom_bar()` function, set `position` to `\"dodge\"`\n\n:::\n\n::: {style=\"font-size: 0.75em;\"}\n\n::: {.cell .column-page-inset-right layout-nrow=\"1\"}\n\n```{.r .cell-code}\nlabs_bar_dodge <- labs(\n  title = \"Adult foraging penguins on Dream island\",\n  subtitle = \"position = 'dodge'\",\n  x = \"Sex\",\n  y = \"Count\",\n  fill = \"Species\")\nggp2_bar_dodge <- ggplot(data = penguins_dodge,\n                    aes(x = sex, \n                        group = species, \n                        fill = species)) +\n                    geom_bar(\n                        position = \"dodge\")\nggp2_bar_dodge +\n  labs_bar_dodge\n```\n\n::: {.cell-output-display}\n![](overlapping_bar_graphs_files/figure-html/code_graph_dodge-1.png){width=100% height=100%}\n:::\n:::\n\n:::\n\n### `dodge2`\n\n::: {style=\"font-size: 1.10em; color: #1e83c8;\"}\n**`dodge2`:**\n:::\n\n::: {.column-margin}\n\n- *works without a grouping variable in a layer*\n\n- *works with bars and rectangles*  \n\n- *useful for arranging graphs with variable widths.*\n\n:::\n\n::: {style=\"font-size: 0.85em;\"}\n\nCreate labels with `labs()`\n\nInitialize the graph with `ggplot()` and provide `data`\n\nMap `species` to `x` and `island` to `fill`\n\nInside `geom_bar()`, set `position` to `\"dodge2\"`\n\n:::\n\n::: {style=\"font-size: 0.75em;\"}\n\n::: {.cell .column-page-inset-right layout-nrow=\"1\"}\n\n```{.r .cell-code}\nlabs_bar_dodge2 <- labs(\n  title = \"Adult foraging penguins on Dream island\",\n  subtitle = \"position = 'dodge2'\",\n  x = \"Sex\",\n  y = \"Count\",\n  fill = \"Species\")\nggp2_bar_dodge2 <- ggplot(data = penguins_dodge,\n                    aes(x = sex, \n                        fill = species)) +\n                    geom_bar(\n                        position = \"dodge2\")\nggp2_bar_dodge2 +\n  labs_bar_dodge2\n```\n\n::: {.cell-output-display}\n![](overlapping_bar_graphs_files/figure-html/create_graph_dodge2-1.png){width=100% height=100%}\n:::\n:::\n\n:::\n\n::: {style=\"font-size: 0.85em;\"}\nCompare the two graphs below:\n:::\n\n\n::: {.cell .column-page-inset-right layout-nrow=\"1\"}\n::: {.cell-output-display}\n![](overlapping_bar_graphs_files/figure-html/compare_bars-1.png){width=100% height=100%}\n:::\n\n::: {.cell-output-display}\n![](overlapping_bar_graphs_files/figure-html/compare_bars-2.png){width=100% height=100%}\n:::\n:::\n\n\n::::\n",
    "supporting": [
      "overlapping_bar_graphs_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}