{
  "hash": "adb34ba9edd1cf75631625d8dd530ea7",
  "result": {
    "markdown": "# Slope graphs {.unnumbered}\n\n\n\n\n\n::: {.callout-tip appearance='simple' icon=false}\n***This graph is largely complete and just needs final proof reading.*** \n:::\n\n\n\n\n:::: {.callout-note collapse=\"false\" icon=false}\n\n::: {style=\"font-size: 1.25em; color: #02577A;\"}\nGraph info\n:::\n\n<br>\n\n\n::: {.cell layout-align=\"right\"}\n::: {.cell-output-display}\n![](slope_graphs_files/figure-html/full_code_display-1.png){fig-align='right' width=60% height=60%}\n:::\n:::\n\n\n\n::: {style=\"font-size: 1.10em; color: #02577A;\"}\n**This graph requires:**\n:::\n\n::: {style=\"font-size: 1.05em; color: #282b2d;\"}\n**✅ a categorical variable**      \n:::\n\n::: {style=\"font-size: 1.05em; color: #282b2d;\"}\n**✅ a numeric (continuous) variable**\n:::\n\n::: {style=\"font-size: 1.05em; color: #282b2d;\"}\n**✅ a numeric (date) variable**\n:::\n\n::::\n\n## Description\n\nSlope graphs show changes in a numeric value (displayed on the `y` axis) typically over two points in time (along the `x` axis). The values for each group or unit of measurement are connected by lines, and any differences between the two time points are represented by the slope of the lines (hence the name, 'slope chart').\n\nWe can build slope graphs in `ggplot2` using the `geom_line()` and `geom_point()` functions.\n\n## Set up\n\n:::: {.panel-tabset}\n\n\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**PACKAGES:**\n:::\n\n::: {style=\"font-size: 0.85em;\"}\nInstall packages.\n:::\n\n\n::: {style=\"font-size: 0.75em;\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\ninstall.packages(\"palmerpenguins\")\nlibrary(palmerpenguins)\nlibrary(ggplot2)\n```\n:::\n\n:::\n\n\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**DATA:**\n:::\n\n::: {.column-margin}\n![Artwork by allison horst](www/lter_penguins.png){fig-align=\"right\" width=\"100%\" height=\"100%\"}\n:::\n\n\n\n::: {style=\"font-size: 0.85em;\"}\nWe'll be using the penguins data for this graph, but slightly restructured. \n:::\n\n::: {style=\"font-size: 0.75em;\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\npeng_slope <- palmerpenguins::penguins |>\n    dplyr::filter(year < 2009) |>\n    dplyr::group_by(year, island) |>\n    dplyr::summarise(across(\n        .cols = contains(\"mm\"), \n        .fns = mean, \n            na.rm = TRUE, \n        .names = \"avg_{.col}\")) |>\n    dplyr::ungroup()\n#> `summarise()` has grouped output by 'year'. You can\n#> override using the `.groups` argument.\nglimpse(peng_slope)\n#> Rows: 6\n#> Columns: 5\n#> $ year                  <int> 2007, 2007, 2007, 2008, 2008…\n#> $ island                <fct> Biscoe, Dream, Torgersen, Bi…\n#> $ avg_bill_length_mm    <dbl> 45.03864, 44.53913, 38.80000…\n#> $ avg_bill_depth_mm     <dbl> 15.54091, 18.57391, 19.02105…\n#> $ avg_flipper_length_mm <dbl> 207.5227, 189.8478, 189.2632…\n```\n:::\n\n:::\n::::\n\n## Grammar \n\n:::: {.panel-tabset}\n\n\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**CODE:**\n:::\n\n::: {style=\"font-size: 0.85em;\"}\n\nCreate labels with `labs()`\n\nInitialize the graph with `ggplot()` and provide `data`\n\nMap `year` to the `x`, `avg_bill_depth_mm` to `y`, and `island` to `group`\n\nAdd a `geom_line()` layer, mapping `island` to `color`, and setting the `size` to `2`\n\nAdd a `geom_point()` layer, mapping `color` to `island`, and setting `size` to `4`\n\nWe'll adjust the `x` axis with `scale_x_continuous()`, manually setting the `breaks` and moving the `position` to the `\"top\"` of the graph\n\n\n:::\n\n::: {style=\"font-size: 0.75em;\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nlabs_slope <- labs(\n        title = \"Changes in Bill Depth of Palmer Penguins\", \n        subtitle = \"Years 2007 & 2008\",\n        x = \"Year\", y = \"Bill Depth (mm)\", \n        color = \"Island\")\n\nggp2_slope <- ggplot(data = peng_slope, \n    mapping = aes(x = year,\n                y = avg_bill_depth_mm, \n                group = island)) +\n  geom_line(aes(color = island), \n                size = 2, show.legend = FALSE) +\n  geom_point(aes(color = island), \n                size = 4) + \n  scale_x_continuous(\n                breaks = c(2007, 2008), \n                position = \"top\")\n\nggp2_slope + \n    labs_slope\n```\n:::\n\n:::\n\n\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**GRAPH:**\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](slope_graphs_files/figure-html/create_graph_slope-1.png){width=100% height=100%}\n:::\n:::\n\n\n::::\n\n## More info\n\nWe can also use faceting with slope graphs to add a third categorical variable.\n\n:::: {.panel-tabset}\n\n \n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**DATA:**\n:::\n\n::: {style=\"font-size: 0.85em;\"}\nWe'll be using the `penguins` dataset again, but group remove the missing values and group it by `year`, `island`, and `sex`. \n:::\n\n::: {style=\"font-size: 0.75em;\"}\n\n::: {.cell}\n\n```{.r .cell-code}\npeng_grp_slope <- palmerpenguins::penguins |>\n    dplyr::select(year, sex, island,\n                  contains(\"mm\")) |> \n    tidyr::drop_na() |> \n    dplyr::filter(year != 2007) |>\n    dplyr::group_by(year, sex, island) |>\n    dplyr::summarise(across(\n        .cols = contains(\"mm\"), \n        .fns = mean, \n            na.rm = TRUE, \n        .names = \"avg_{.col}\")) |>\n    dplyr::ungroup()\n#> `summarise()` has grouped output by 'year', 'sex'. You can\n#> override using the `.groups` argument.\nglimpse(peng_grp_slope)\n#> Rows: 12\n#> Columns: 6\n#> $ year                  <int> 2008, 2008, 2008, 2008, 2008…\n#> $ sex                   <fct> female, female, female, male…\n#> $ island                <fct> Biscoe, Dream, Torgersen, Bi…\n#> $ avg_bill_length_mm    <dbl> 42.78387, 41.42353, 36.61250…\n#> $ avg_bill_depth_mm     <dbl> 15.02903, 17.52941, 17.40000…\n#> $ avg_flipper_length_mm <dbl> 205.3226, 190.9412, 190.0000…\n```\n:::\n\n\n:::\n\n\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**GRAPH:**\n:::\n\n::: {style=\"font-size: 0.85em;\"}\n\nCreate labels with `labs()` \n\nInitialize the graph with `ggplot()` and provide `data`\n\nMap `year` to the `x`, `avg_bill_depth_mm` to `y`, and `island` to `group`\n\nAdd a `geom_line()` layer, mapping `island` to `color`, and setting the `size` to `2`\n\nAdd a `geom_point()` layer, mapping `color` to `island`, and setting `size` to `4`\n\nWe'll adjust the `x` axis with `scale_x_continuous()`, manually setting the `breaks` and moving the `position` to the `\"top\"` of the graph\n\nWe'll duplicate the the `y` axis with `sec.axis`, setting `dup_axis()` to the same `name` of the previous `y` label.\n\nFinally, we facet the graph by `sex`, adjust the `size` of the text, and move the legend to the `\"bottom\"` of the graph.\n:::\n\n::: {style=\"font-size: 0.75em;\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nlabs_grp_slope <- labs(\n    title = \"Changes in Bill Depth of Palmer Penguins\",\n    subtitle = \"Years 2008 & 2009\",\n    x = \"\",\n    color = \"Island\")\n\nggp2_grp_slope <- ggplot(data = peng_grp_slope,\n    mapping = aes(x = year,\n        y = avg_bill_depth_mm,\n        group = island)) +\n    geom_line(aes(color = island),\n        size = 2, show.legend = FALSE) +\n    geom_point(aes(color = island),\n        size = 4) +\n    scale_x_continuous(breaks = c(2008, 2009),\n        position = \"top\") +\n    scale_y_continuous(name = \"Bill Depth (mm)\",\n        sec.axis = dup_axis(name = \"Bill Depth (mm)\")) +\n    facet_wrap(. ~ sex,\n        ncol = 2) +\n    theme_minimal(base_size = 14) +\n    theme(\n        legend.position = \"bottom\",\n        axis.text.x = element_text(size = 9),\n        axis.text.y = element_text(size = 9),\n        strip.text = element_text(size = 10))\n\nggp2_grp_slope +\n    labs_grp_slope\n```\n\n::: {.cell-output-display}\n![](slope_graphs_files/figure-html/create_graph_grp_slope-1.png){width=100% height=100%}\n:::\n:::\n\n:::\n\n::::\n",
    "supporting": [
      "slope_graphs_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}