{
  "hash": "e7c355d8026ffc67d7323f0678a5b05d",
  "result": {
    "markdown": "# Hexagon bins {#sec-hex-bins}\n\n\n\n\n\n::: {.callout-tip appearance='simple' icon=false}\n***This graph is largely complete and just needs final proof reading.*** \n:::\n\n\n:::: {.callout-note collapse=\"false\" icon=false}\n\n<br>\n\n\n::: {.cell layout-align=\"right\"}\n::: {.cell-output-display}\n![](hex_bins_files/figure-html/full_code_display-1.png){fig-align='right' width=60% height=60%}\n:::\n:::\n\n\n::: {style=\"font-size: 1.10em; color: #02577A;\"}\n**This graph requires:**\n:::\n\n::: {style=\"font-size: 1.05em; color: #282b2d;\"}\n**✅ two numeric (continuous) variable**\n:::\n\n::::\n\n## Description \n\nHexagon bins (or hex-bins) are a very similar to 2-D histograms, but instead of dividing the graph area into a grid, it's divided into hexagons. The number of points inside each per hexagon determine it's color. \n\n\n## Set up\n\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**PACKAGES:**\n:::\n\nInstall packages.\n\n::: {style=\"font-size: 0.85em;\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\ninstall.packages(\"palmerpenguins\")\nlibrary(palmerpenguins)\nlibrary(ggplot2)\n```\n:::\n\n:::\n\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**DATA:**\n:::\n\n::: {.column-margin}\n![Artwork by allison horst](www/lter_penguins.png){fig-align=\"right\" width=\"100%\" height=\"100%\"}\n:::\n\n\n\nWe'll take the `flipper_length_mm`, `bill_length_mm`, `bill_depth_mm`, `species`, `sex`, and `island` variables from `palmerpenguins::penguins` and drop the missing values.\n\n::: {style=\"font-size: 0.85em;\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\npenguins_hex <- palmerpenguins::penguins |> \n    dplyr::select(flipper_length_mm, bill_depth_mm,\n        bill_length_mm, species, sex, island) |> \n    tidyr::drop_na()\nglimpse(penguins_hex)\n#> Rows: 333\n#> Columns: 6\n#> $ flipper_length_mm <int> 181, 186, 195, 193, 19…\n#> $ bill_depth_mm     <dbl> 18.7, 17.4, 18.0, 19.3…\n#> $ bill_length_mm    <dbl> 39.1, 39.5, 40.3, 36.7…\n#> $ species           <fct> Adelie, Adelie, Adelie…\n#> $ sex               <fct> male, female, female, …\n#> $ island            <fct> Torgersen, Torgersen, …\n```\n:::\n\n:::\n\n## Grammar\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**CODE:**\n:::\n\n  - Create labels with `labs()`\n\n  - Initialize the graph with `ggplot()` and provide `data`\n\n  - Map `bill_length_mm` to the `x` and `flipper_length_mm` to the `y`\n\n  - Add the `geom_hex()` layer\n\n::: {style=\"font-size: 0.85em;\"}\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nlabs_hex <- labs(\n    title = \"Adult Foraging Penguins\", \n    subtitle = \"Near Palmer Station, Antarctica\", \n    x = \"Bill length (mm)\", \n    y = \"Flipper length (mm)\")\n# graph\nggp2_hex <- ggplot(data = penguins_hex, \n    aes(x = bill_length_mm, y = flipper_length_mm)) + \n    geom_hex()\n\nggp2_hex + \n    labs_hex\n```\n:::\n\n:::\n\n::: {style=\"font-size: 1.15em; color: #1e83c8;\"}\n**GRAPH:**\n:::\n\n::: {style=\"font-size: 0.85em;\"}\n\n::: {.cell .column-page-inset-right layout-nrow=\"1\"}\n::: {.cell-output-display}\n![](hex_bins_files/figure-html/create_graph_hex-1.png){width=100% height=100%}\n:::\n:::\n\n:::\n\n## More info\n\n### Bins\n\nBelow we change the `bins` to `20` and `15` and save these layers as `ggp2_hex_b20` and `ggp2_hex_b15`.\n\n*Decreasing* the number of `bins` *increases* the size of the hexagons (and makes them larger). \n\n::: {style=\"font-size: 0.85em;\"}\n\n::: {.cell .column-page-inset-right layout-nrow=\"1\"}\n\n```{.r .cell-code}\nggp2_hex_b20 <- ggplot(data = penguins_hex,\n    aes(x = bill_length_mm, y = flipper_length_mm)) +\n    geom_hex(bins = 20)\nggp2_hex_b20 +\n    labs_hex\n\n\nggp2_hex_b15 <- ggplot(data = penguins_hex,\n    aes(x = bill_length_mm, y = flipper_length_mm)) +\n    geom_hex(bins = 15)\nggp2_hex_b15 +\n    labs_hex\n```\n\n::: {.cell-output-display}\n![](hex_bins_files/figure-html/bins_hex-1.png){width=100% height=100%}\n:::\n\n::: {.cell-output-display}\n![](hex_bins_files/figure-html/bins_hex-2.png){width=100% height=100%}\n:::\n:::\n\n\n:::\n\n### Scale\n\n  - We can adjust the color scale using  `scale_color_discrete_sequential()` and setting `aesthetics` to `\"fill\"`. \n\n  - If the hexagons overlap, we can use the `alpha` to make them slightly transparent. \n\n::: {style=\"font-size: 0.85em;\"}\n\n::: {.cell .column-page-inset-right layout-nrow=\"1\"}\n\n```{.r .cell-code}\nlabs_hex2 <- labs(\n    title = \"Adult Foraging Penguins\", \n    subtitle = \"Near Palmer Station, Antarctica\", \n    x = \"Bill length (mm)\", \n    y = \"Flipper length (mm)\",\n    fill = \"Sex\")\nggplot(data = penguins_hex, \n    aes(x = bill_length_mm, \n        y = flipper_length_mm)) + \n    geom_hex(aes(fill = sex), \n             bins = 15, \n             alpha = 3/4) + \n    scale_color_discrete_sequential(\n        aesthetics = \"fill\", \n        rev = FALSE,\n        palette = \"Viridis\") +\n    labs_hex2\n```\n\n::: {.cell-output-display}\n![](hex_bins_files/figure-html/scales_2d_hex-1.png){width=100% height=100%}\n:::\n:::\n\n:::\n\nGet a full list of available color palette's using `hcl_palettes(type = ` `\"sequential\")`\n\n### Options\n\n  - `binwidth` allows us to manually adjust the size of the hexagons.\n\n  - `linewidth` is also helpful when using `alpha` for overlapping values. \n\n::: {style=\"font-size: 0.85em;\"}\n\n::: {.cell .column-page-inset-right layout-nrow=\"1\"}\n\n```{.r .cell-code}\nlabs_hex3 <- labs(\n    title = \"Adult Foraging Penguins\", \n    subtitle = \"Near Palmer Station, Antarctica\", \n    x = \"Bill length (mm)\", \n    y = \"Flipper length (mm)\",\n    fill = \"Species\")\n\nggplot(data = penguins_hex, \n    aes(x = bill_length_mm, \n        y = flipper_length_mm, \n        fill = species)) + \n    geom_hex(binwidth = c(1.1, 3),\n        linewidth = 0.5, \n        alpha = 3/4,\n        color = \"#000000\") + \n    scale_color_discrete_sequential(\n        aesthetics = \"fill\", \n        palette = \"Dark Mint\") +\n    labs_hex3\n```\n\n::: {.cell-output-display}\n![](hex_bins_files/figure-html/pals_2d_hex-1.png){width=100% height=100%}\n:::\n:::\n\n:::\n\n\nBins can be set with `bins` (a single number) or `binwidth` (a numeric vector of `c(x, y)`)\n",
    "supporting": [
      "hex_bins_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}